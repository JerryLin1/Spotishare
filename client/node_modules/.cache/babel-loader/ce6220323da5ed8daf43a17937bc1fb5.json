{"ast":null,"code":"import _asyncToGenerator from\"C:\\\\Users\\\\Tiezh\\\\Desktop\\\\Spotishare\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Tiezh\\\\Desktop\\\\Spotishare\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React from\"react\";import ReactDOM from\"react-dom\";import{BrowserRouter,Route,MemoryRouter,Routes}from\"react-router-dom\";import{ClientProvider}from\"./contexts/ClientProvider\";import HomePage from\"./Home\";import Lobby from\"./Lobby\";import PreLobby from\"./PreLobby\";import\"./css/styles.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";ReactDOM.render(/*#__PURE__*/_jsx(React.StrictMode,{children:/*#__PURE__*/_jsx(ClientProvider,{children:/*#__PURE__*/_jsx(BrowserRouter,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(HomePage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/:roomId\",element:/*#__PURE__*/_jsx(PreLobby,{})}),/*#__PURE__*/_jsx(Route,{path:\"/:roomId/Lobby\",element:/*#__PURE__*/_jsx(Lobby,{})})]})})})}),document.getElementById(\"root\"));document.addEventListener(\"DOMContentLoaded\",function(){if(localStorage.getItem(\"spotify-access-token\")&&localStorage.getItem(\"spotify-access-token-expiry\")>Date.now()){//TODO: Tell user to login?\n}if(window.location.pathname==\"/auth/callback\"){fetch(\"/auth/callback\"+window.location.search).then(function(e){return e.json();}).then(function(data){localStorage.setItem(\"spotify-access-token\",data.accessToken);localStorage.setItem(\"spotify-access-token-expiry\",Date.now()+data.expiresIn*990);localStorage.setItem(\"spotify-refresh-token\",data.refreshToken);window.location=localStorage.getItem(\"prev-location\")||\"/\";});}});export function isLoggedIn(){return localStorage.getItem(\"spotify-access-token\")&&localStorage.getItem(\"spotify-access-token-expiry\")>Date.now();}export function login(){return _login.apply(this,arguments);}function _login(){_login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:fetch(\"/auth/login\").then(function(e){return e.json();}).then(function(data){localStorage.setItem(\"prev-location\",window.location);window.location=data.redirectUri;}).catch(function(error){alert(error);});case 1:case\"end\":return _context.stop();}}},_callee);}));return _login.apply(this,arguments);}","map":{"version":3,"sources":["C:/Users/Tiezh/Desktop/Spotishare/client/src/index.js"],"names":["React","ReactDOM","BrowserRouter","Route","MemoryRouter","Routes","ClientProvider","HomePage","Lobby","PreLobby","render","document","getElementById","addEventListener","localStorage","getItem","Date","now","window","location","pathname","fetch","search","then","e","json","data","setItem","accessToken","expiresIn","refreshToken","isLoggedIn","login","redirectUri","catch","error","alert"],"mappings":"oQAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,QAAP,KAAqB,WAArB,CACA,OAASC,aAAT,CAAwBC,KAAxB,CAA+BC,YAA/B,CAA6CC,MAA7C,KAA2D,kBAA3D,CACA,OAASC,cAAT,KAA+B,2BAA/B,CACA,MAAOC,CAAAA,QAAP,KAAqB,QAArB,CACA,MAAOC,CAAAA,KAAP,KAAkB,SAAlB,CACA,MAAOC,CAAAA,QAAP,KAAqB,YAArB,CAEA,MAAO,kBAAP,C,wFAEAR,QAAQ,CAACS,MAAT,cACI,KAAC,KAAD,CAAO,UAAP,wBACI,KAAC,cAAD,wBACI,KAAC,aAAD,wBACI,MAAC,MAAD,yBACI,KAAC,KAAD,EAAO,IAAI,CAAC,GAAZ,CAAgB,OAAO,cAAE,KAAC,QAAD,IAAzB,EADJ,cAEI,KAAC,KAAD,EAAO,IAAI,CAAC,UAAZ,CAAuB,OAAO,cAAE,KAAC,QAAD,IAAhC,EAFJ,cAGI,KAAC,KAAD,EAAO,IAAI,CAAC,gBAAZ,CAA6B,OAAO,cAAE,KAAC,KAAD,IAAtC,EAHJ,GADJ,EADJ,EADJ,EADJ,CAYIC,QAAQ,CAACC,cAAT,CAAwB,MAAxB,CAZJ,EAeAD,QAAQ,CAACE,gBAAT,CAA0B,kBAA1B,CAA8C,UAAM,CAChD,GACIC,YAAY,CAACC,OAAb,CAAqB,sBAArB,GACAD,YAAY,CAACC,OAAb,CAAqB,6BAArB,EAAsDC,IAAI,CAACC,GAAL,EAF1D,CAGE,CACE;AACH,CACD,GAAIC,MAAM,CAACC,QAAP,CAAgBC,QAAhB,EAA4B,gBAAhC,CAAkD,CAC9CC,KAAK,CAAC,iBAAmBH,MAAM,CAACC,QAAP,CAAgBG,MAApC,CAAL,CACKC,IADL,CACU,SAACC,CAAD,QAAOA,CAAAA,CAAC,CAACC,IAAF,EAAP,EADV,EAEKF,IAFL,CAEU,SAACG,IAAD,CAAU,CACZZ,YAAY,CAACa,OAAb,CAAqB,sBAArB,CAA6CD,IAAI,CAACE,WAAlD,EACAd,YAAY,CAACa,OAAb,CAAqB,6BAArB,CAAoDX,IAAI,CAACC,GAAL,GAAaS,IAAI,CAACG,SAAL,CAAiB,GAAlF,EACAf,YAAY,CAACa,OAAb,CAAqB,uBAArB,CAA8CD,IAAI,CAACI,YAAnD,EACAZ,MAAM,CAACC,QAAP,CAAkBL,YAAY,CAACC,OAAb,CAAqB,eAArB,GAAyC,GAA3D,CACH,CAPL,EAQH,CACJ,CAjBD,EAmBA,MAAO,SAASgB,CAAAA,UAAT,EAAsB,CACzB,MACIjB,CAAAA,YAAY,CAACC,OAAb,CAAqB,sBAArB,GAAgDD,YAAY,CAACC,OAAb,CAAqB,6BAArB,EAAsDC,IAAI,CAACC,GAAL,EAD1G,CAGH,CACD,eAAsBe,CAAAA,KAAtB,wC,iFAAO,mIACHX,KAAK,CAAC,aAAD,CAAL,CACKE,IADL,CACU,SAACC,CAAD,QAAOA,CAAAA,CAAC,CAACC,IAAF,EAAP,EADV,EAEKF,IAFL,CAEU,SAACG,IAAD,CAAU,CACZZ,YAAY,CAACa,OAAb,CAAqB,eAArB,CAAsCT,MAAM,CAACC,QAA7C,EACAD,MAAM,CAACC,QAAP,CAAkBO,IAAI,CAACO,WAAvB,CACH,CALL,EAMKC,KANL,CAMW,SAACC,KAAD,CAAW,CACdC,KAAK,CAACD,KAAD,CAAL,CACH,CARL,EADG,sD","sourcesContent":["import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { BrowserRouter, Route, MemoryRouter, Routes } from \"react-router-dom\";\nimport { ClientProvider } from \"./contexts/ClientProvider\";\nimport HomePage from \"./Home\";\nimport Lobby from \"./Lobby\";\nimport PreLobby from \"./PreLobby\";\n\nimport \"./css/styles.css\";\n\nReactDOM.render(\n    <React.StrictMode>\n        <ClientProvider>\n            <BrowserRouter>\n                <Routes>\n                    <Route path=\"/\" element={<HomePage />}></Route>\n                    <Route path=\"/:roomId\" element={<PreLobby />}></Route>\n                    <Route path=\"/:roomId/Lobby\" element={<Lobby />}></Route>\n                </Routes>\n            </BrowserRouter>\n        </ClientProvider>\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n);\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    if (\n        localStorage.getItem(\"spotify-access-token\") &&\n        localStorage.getItem(\"spotify-access-token-expiry\") > Date.now()\n    ) {\n        //TODO: Tell user to login?\n    }\n    if (window.location.pathname == \"/auth/callback\") {\n        fetch(\"/auth/callback\" + window.location.search)\n            .then((e) => e.json())\n            .then((data) => {\n                localStorage.setItem(\"spotify-access-token\", data.accessToken);\n                localStorage.setItem(\"spotify-access-token-expiry\", Date.now() + data.expiresIn * 990);\n                localStorage.setItem(\"spotify-refresh-token\", data.refreshToken);\n                window.location = localStorage.getItem(\"prev-location\") || \"/\";\n            });\n    }\n});\n\nexport function isLoggedIn() {\n    return (\n        localStorage.getItem(\"spotify-access-token\") && localStorage.getItem(\"spotify-access-token-expiry\") > Date.now()\n    );\n}\nexport async function login() {\n    fetch(\"/auth/login\")\n        .then((e) => e.json())\n        .then((data) => {\n            localStorage.setItem(\"prev-location\", window.location);\n            window.location = data.redirectUri;\n        })\n        .catch((error) => {\n            alert(error);\n        });\n}\n"]},"metadata":{},"sourceType":"module"}